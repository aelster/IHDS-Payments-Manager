#!/bin/bash

user=`whoami`
base="`dirname ~`/$user"
echo "base: [$base]"
echo

#==================================================

dest="Common-IHDS-Societies"
if [ $user = andy ]; then
    path="/usr/local/site"
else
    path="$base/site"
fi

cd $path
file=`find . -name "common-dev" -type d -exec basename {} \; | sort -r | head -n 1`
ln -sfn $file $dest
s=`readlink $path/$dest`
printf '%-25s:  %s\n' $dest $file

#==================================================

dest="Site-IHDS-Societies"
if [ $user = andy ]; then
    path="/usr/local/site/ihds"
else
    path="$base/site/ihds"
fi

cd $path
file=`find . -name "societies-dev" -type d -exec basename {} \; | sort -r | head -n 1`
ln -sfn $file $dest
s=`readlink $path/$dest`
printf '%-25s:  %s\n' $dest $file

#==================================================

dest="pm"
if [ $user = andy ]; then
    path="/Users/andy/src/websites/ihds"
else
    path="$base/public_html/irvinehebrewday"
fi

cd $path
file=`find . -name "societies-dev" -type d -exec basename {} \; | sort -r | head -n 1`
ln -sfn $file $dest
s=`readlink $path/$dest`
printf '%-25s:  %s\n' $dest $file

echo

#!************************************************************
#! Now that links have changed, update/install the links to 
#! both Common.css and Common.js
#!************************************************************

if [ "$user" = "joylearn" ]; then
    cd ~/public_html/irvinehebrewday/$dest/css
    rm Common.css
    ln -s ~/site/Common-IHDS-Societies/css/Common.css Common.css

    cd ../scripts
    rm Common.js
    ln -s ~/site/Common-IHDS-Societies/scripts/Common.js Common.js

else
    cd ~/src/websites/ihds/$dest/css
    rm Common.css
    ln -s /usr/local/site/Common-IHDS-Societies/css/Common.css Common.css

    cd ../scripts
    rm Common.js
    ln -s /usr/local/site/Common-IHDS-Societies/scripts/Common.js Common.js
fi
    
cd $start_dir
